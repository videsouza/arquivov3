<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Etiquetas | Hub de Serviços</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Playfair+Display:wght@700&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#f7931e', // Laranja do Hub
                        'primary-hover': '#d67d12',
                        dark: '#1f2937', // Cinza Escuro do Hub
                        light: '#f9f9f9'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* --- GERAL --- */
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; overflow: hidden; }
        
        /* --- AUTOCOMPLETE --- */
        .autocomplete-list {
            position: absolute; top: 100%; left: 0; right: 0;
            background: white; border: 1px solid #cbd5e1;
            border-radius: 0 0 8px 8px; max-height: 200px; overflow-y: auto;
            z-index: 50; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); display: none;
        }
        .autocomplete-item {
            padding: 8px 12px; font-size: 11px; cursor: pointer;
            border-bottom: 1px solid #f1f5f9; color: #334155;
        }
        .autocomplete-item:hover { background-color: #f3f4f6; color: #000; }
        .autocomplete-item strong { color: #f7931e; margin-right: 5px; }

        /* --- PREVIEW --- */
        .sheet-container {
            width: 210mm; min-height: 296mm; background: white;
            padding: 10mm; box-sizing: border-box; margin: 0 auto;
            display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: repeat(3, 1fr);
            gap: 5mm; box-shadow: 0 0 15px rgba(0,0,0,0.05);
        }
        .etiqueta-box {
            border: 1px dashed #e5e7eb; height: 100%; overflow: hidden;
            position: relative; background: #fff; padding: 4px; box-sizing: border-box;
        }

        /* --- CSS DE IMPRESSÃO (CRÍTICO) --- */
        @media print {
            @page { size: A4; margin: 0; }
            body, html { margin: 0; padding: 0; background-color: white !important; width: 210mm; height: 297mm; }
            aside, header, .no-print, button, .shadow-lg, .border-r { display: none !important; }
            main, .flex-1 { margin: 0 !important; padding: 0 !important; background: white !important; overflow: visible !important; position: static !important; width: 100% !important; height: 100% !important; display: block !important; }
            .sheet-container { width: 210mm !important; height: 296mm !important; margin: 0 !important; padding: 10mm !important; box-shadow: none !important; border: none !important; transform: none !important; position: absolute; top: 0; left: 0; display: grid !important; }
            .etiqueta-box { border: 1px dashed #ccc !important; } 
        }

        /* --- LAYOUTS DAS ETIQUETAS --- */

        /* 1. PADRÃO (Eliminação & Permanente) */
        .layout-padrao-box {
            border: 2px solid #000; height: 100%; 
            padding: 8px; 
            display: flex; flex-direction: column; font-family: Arial, sans-serif;
        }
        .eli-header {
            text-align: center; font-weight: 900; text-transform: uppercase;
            font-size: 14px; border-bottom: 2px solid #000; 
            padding-bottom: 2px; margin-bottom: 4px;
        }
        .eli-row { display: flex; gap: 8px; margin-bottom: 4px; align-items: baseline; }
        .eli-label { font-weight: 700; font-size: 11px; white-space: nowrap; color: #000; }
        .eli-value {
            border-bottom: 1px dotted #000; flex: 1; font-size: 12px; font-weight: 600; padding-left: 5px;
            min-height: 16px; font-family: 'Roboto Mono', monospace; color: #000;
        }
        .eli-blank-line { border-bottom: 1px solid #000; display: inline-block; height: 14px; margin-left: 5px; }
        .eli-fixed { font-size: 11px; font-weight: 800; color: #000000 !important; text-transform: uppercase; }
        .eli-desc-box {
            border: 1px solid #000; flex: 1; padding: 5px; font-size: 11px; margin-top: 2px;
            min-height: 80px; color: #000;
        }

        /* 2. AMOSTRAGEM */
        .layout-amostragem { border: 3px double #000; height: 100%; padding: 15px; display: flex; flex-direction: column; }
        
        /* 3. NUMÉRICA */
        .layout-numero { border: 5px solid #000; height: 100%; display: flex; flex-direction: column; text-align: center; }
        .num-header { 
            background: #000; color: #fff; padding: 5px; height: 60px; display: flex; align-items: center; justify-content: center; 
            -webkit-print-color-adjust: exact; print-color-adjust: exact;
        }
        .num-header span { font-size: 40px; font-weight: 800; font-family: 'Inter', sans-serif; line-height: 1; }
        .num-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 10px; overflow: hidden; }
        .texto-setor { font-size: 30px; font-weight: 800; text-transform: uppercase; line-height: 1.1; font-family: 'Inter', sans-serif; color: #000; }
        .num-footer { 
            border-top: 4px solid #000; padding: 8px; font-size: 20px; font-weight: 700; background: #f1f1f1; 
            -webkit-print-color-adjust: exact; print-color-adjust: exact;
        }
        
        /* Utilitários */
        .campo-linha { display: flex; align-items: baseline; border-bottom: 1px dotted #999; padding-bottom: 2px; margin-bottom: 6px; }
        .campo-label { font-weight: 700; font-size: 11px; min-width: 70px; color: #333; text-transform: uppercase; }
        .campo-valor { font-weight: 600; font-size: 13px; color: #000; flex: 1; margin-left: 5px; font-family: 'Roboto Mono', monospace; }
        .campo-area { margin-top: 4px; flex: 1; border: 1px solid #ddd; padding: 5px; font-size: 11px; background: #fafafa; }
    </style>
</head>
<body class="flex h-screen text-gray-800">

    <aside class="w-72 bg-dark text-white flex flex-col justify-between hidden md:flex no-print h-full shrink-0 shadow-xl z-30">
        <div>
            <div class="p-8 border-b border-gray-700">
                <h1 class="text-2xl font-light tracking-wide text-white">Hub<span class="font-bold text-primary">.Doc</span></h1>
                <p class="text-[10px] text-gray-400 mt-2 font-light tracking-wider uppercase">Hub de Serviços</p>
            </div>
            
            <nav class="mt-8 px-4 space-y-3">
                <a href="index.html" class="w-full text-left px-4 py-3 rounded border border-gray-600 hover:bg-gray-700 text-gray-300 hover:text-white transition flex items-center gap-3 mb-6">
                    <i class="fa-solid fa-arrow-left w-5 text-primary"></i> <span class="font-medium text-sm">Voltar ao Início</span>
                </a>
                
                <div class="px-4 py-2 text-[10px] text-gray-500 uppercase tracking-widest font-bold border-b border-gray-700 mb-2">Ferramentas</div>
                
                <button onclick="window.print()" class="w-full text-left px-4 py-3 rounded bg-primary hover:bg-primary-hover text-white shadow-lg transition flex items-center gap-3">
                    <i class="fa-solid fa-print w-5"></i> <span class="font-medium text-sm">Imprimir</span>
                </button>
                <button onclick="limparFolha()" class="w-full text-left px-4 py-3 rounded hover:bg-gray-700 text-gray-400 hover:text-white transition flex items-center gap-3">
                    <i class="fa-solid fa-eraser w-5"></i> <span class="font-medium text-sm">Limpar Tudo</span>
                </button>
            </nav>
        </div>
        
        <div class="p-6 border-t border-gray-700 bg-gray-900/50">
            <p class="text-[10px] text-gray-500 text-center leading-relaxed">
                Sistema de Gestão Documental<br>
                &copy; 2025 Todos os direitos reservados.
            </p>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-full overflow-hidden main-content bg-light">
        
        <header class="bg-white border-b border-gray-200 p-4 flex justify-between items-center shadow-sm z-10 no-print shrink-0 h-16">
            <div>
                <h2 class="text-lg font-bold text-dark flex items-center gap-2">
                    <i class="fa-solid fa-tags text-primary"></i> Gerador de Etiquetas
                </h2>
                <p class="text-[10px] text-gray-500 font-medium ml-7">Configure os dados e adicione à folha A4.</p>
            </div>
            <div class="text-[10px] text-gray-400 bg-gray-50 px-3 py-1 rounded border border-gray-100">
                <i class="fa-solid fa-circle-info mr-1"></i> Impressão: Margem Nenhuma, Escala 100%
            </div>
        </header>

        <div class="flex-1 flex overflow-hidden">
            
            <div class="w-[360px] bg-white border-r border-gray-200 p-6 overflow-y-auto no-print shadow-[4px_0_24px_rgba(0,0,0,0.02)] z-20 flex flex-col">
                
                <div class="flex gap-2 mb-6 p-1 bg-gray-100 rounded-lg shrink-0 border border-gray-200">
                    <button onclick="setModelo('padrao')" id="btn-padrao" class="flex-1 py-2 text-xs font-bold rounded shadow-sm bg-white text-primary transition border border-gray-200">PADRÃO</button>
                    <button onclick="setModelo('numero')" id="btn-numero" class="flex-1 py-2 text-xs font-bold rounded text-gray-500 hover:bg-white hover:text-dark transition">NUMÉRICA</button>
                </div>

                <form id="formEtiqueta" onsubmit="adicionar(event)" class="space-y-4 flex-1 flex flex-col">
                    
                    <div id="campos-padrao" class="flex flex-col gap-3">
                        
                        <div class="bg-orange-50/50 p-3 rounded-lg border border-orange-100">
                            <label class="block text-[10px] font-bold text-gray-400 uppercase mb-2">Finalidade</label>
                            <select id="subtipo_padrao" onchange="toggleCamposEliminacao()" class="w-full text-xs p-2 rounded border border-gray-300 outline-none focus:border-primary focus:ring-1 focus:ring-primary font-bold text-dark bg-white">
                                <option value="eliminacao">ELIMINAÇÃO</option>
                                <option value="permanente">GUARDA PERMANENTE</option>
                                <option value="amostragem">AMOSTRAGEM</option>
                            </select>
                        </div>

                        <div class="relative">
                            <label id="lbl-setor-principal" class="block text-[10px] font-bold text-gray-500 uppercase mb-1">Portador / Setor</label>
                            <div class="relative">
                                <input type="text" id="p_unidade" oninput="buscarSetor(this, 'sugestoes-padrao')" autocomplete="off" class="w-full border border-gray-300 p-2 pl-8 rounded text-xs focus:border-primary focus:ring-1 focus:ring-primary outline-none uppercase font-bold text-dark" placeholder="DIGITE O CÓDIGO OU NOME...">
                                <i class="fa-solid fa-search absolute left-2.5 top-2.5 text-gray-400 text-xs"></i>
                            </div>
                            <div id="sugestoes-padrao" class="autocomplete-list"></div>
                        </div>

                        <div id="inputs-comuns" class="space-y-3 p-3 bg-gray-50 rounded border border-gray-200">
                            <div class="flex gap-2">
                                <div class="w-1/3">
                                    <label class="block text-[10px] font-bold text-gray-700 uppercase mb-1">Nº Doc</label>
                                    <input type="text" id="eli_num_doc" class="w-full border border-gray-300 p-2 rounded text-xs focus:border-primary outline-none">
                                </div>
                                <div class="w-2/3">
                                    <label class="block text-[10px] font-bold text-gray-700 uppercase mb-1">Ano Doc (30/12/..)</label>
                                    <input type="number" id="eli_ano_data" class="w-full border border-gray-300 p-2 rounded text-xs focus:border-primary outline-none" placeholder="Ex: 2024">
                                </div>
                            </div>

                            <div class="flex gap-2">
                                <div class="w-1/2">
                                    <label class="block text-[10px] font-bold text-gray-700 uppercase mb-1">Tipo</label>
                                    <input type="text" id="eli_tipo" class="w-full border border-gray-300 p-2 rounded text-xs focus:border-primary outline-none">
                                </div>
                                <div class="w-1/2">
                                    <label class="block text-[10px] font-bold text-gray-700 uppercase mb-1">Qtd (cm)</label>
                                    <input type="number" id="eli_qtd" class="w-full border border-gray-300 p-2 rounded text-xs focus:border-primary outline-none" placeholder="Vazio p/ manual">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-[10px] font-bold text-gray-700 uppercase mb-1">Descrição</label>
                                <textarea id="eli_desc" rows="3" class="w-full border border-gray-300 p-2 rounded text-xs focus:border-primary outline-none"></textarea>
                            </div>

                            <div id="row-ano-elim">
                                <label class="block text-[10px] font-bold text-primary uppercase mb-1">Ano Eliminação (31/12/..)</label>
                                <input type="number" id="eli_ano_elim" class="w-full border border-primary/30 p-2 rounded text-xs font-bold bg-white text-primary focus:border-primary outline-none" placeholder="Ex: 2030">
                            </div>
                        </div>

                        <div id="inputs-amostragem" class="hidden space-y-3">
                            <div class="grid grid-cols-2 gap-2">
                                <div><label class="block text-[10px] font-bold text-gray-500 uppercase mb-1">Processo/Cx</label><input type="text" id="a_processo" class="w-full border p-2 rounded text-xs"></div>
                                <div><label class="block text-[10px] font-bold text-gray-500 uppercase mb-1">Data</label><input type="text" id="a_data" class="w-full border p-2 rounded text-xs"></div>
                            </div>
                            <div><label class="block text-[10px] font-bold text-gray-500 uppercase mb-1">Descrição</label><textarea id="a_desc" rows="3" class="w-full border p-2 rounded text-xs"></textarea></div>
                        </div>
                    </div>

                    <div id="campos-numero" class="hidden flex flex-col gap-3">
                        <div><label class="block text-[10px] font-bold text-gray-500 uppercase mb-1">Número Grande</label><input type="number" id="n_numero" class="w-full border border-gray-300 p-2 rounded text-3xl font-bold text-center focus:border-primary outline-none text-dark" placeholder="93"></div>
                        <div class="relative">
                            <label class="block text-[10px] font-bold text-gray-500 uppercase mb-1">Nome do Setor</label>
                            <div class="relative">
                                <input type="text" id="n_setor" oninput="buscarSetor(this, 'sugestoes-numero')" autocomplete="off" class="w-full border border-gray-300 p-2 pl-8 rounded text-xs focus:border-primary outline-none font-bold uppercase" placeholder="BUSCAR SETOR...">
                                <i class="fa-solid fa-search absolute left-2.5 top-2.5 text-gray-400 text-xs"></i>
                            </div>
                            <div id="sugestoes-numero" class="autocomplete-list"></div>
                        </div>
                        <div><label class="block text-[10px] font-bold text-gray-500 uppercase mb-1">Data/Ano</label><input type="text" id="n_data" class="w-full border border-gray-300 p-2 rounded text-xs focus:border-primary outline-none" placeholder="2025"></div>
                    </div>

                    <div class="mt-auto pt-4">
                        <button type="submit" class="w-full bg-dark text-white py-3 rounded-lg font-bold hover:bg-black transition flex justify-center items-center gap-2 shadow-lg group">
                            <i class="fa-solid fa-plus-circle text-primary group-hover:scale-110 transition-transform"></i> Adicionar à Folha
                        </button>
                        <button type="button" onclick="preencherRestante()" class="w-full text-gray-400 text-xs py-2 mt-2 hover:text-primary underline text-center block transition">
                            Preencher espaços vazios
                        </button>
                    </div>
                </form>
            </div>

            <div class="flex-1 overflow-auto bg-gray-100 p-8 flex justify-center relative">
                <div class="absolute bottom-4 right-4 text-gray-300 font-bold text-5xl opacity-10 pointer-events-none select-none no-print">Hub.Doc</div>
                
                <div id="folha-a4" class="sheet-container scale-[0.75] origin-top md:scale-100 transition-transform">
                    </div>
            </div>
        </div>
    </main>

    <script>
        // --- BASE DE DADOS COMPLETA ---
        // ATENÇÃO: ABAIXO ESTÁ A LISTA DE SETORES. 
        // POR QUESTÃO DE ESPAÇO, A LISTA FOI ABREVIADA.
        // COPIE A LISTA COMPLETA QUE VOCÊ POSSUI DO CSV E COLE AQUI.
        
        const BASE_SETORES = [
            {c:1,n:"SE - DAF - COORDENADORIA DE INFORMÁTICA"},{c:2,n:"CORPO DE BOMBEIROS"},{c:3,n:"CRECHE JARDIM CASTANHEIRAS"},
            {c:4,n:"CRECHE JARDIM FLAMBOYANT"},{c:5,n:"CRECHE JARDIM TELESPARK"},{c:6,n:"EMEF PROF ANA BERLING DE MACEDO"},
            {c:7,n:"EMEF PROF ANTÔNIO PALMA SOBRINHO"},{c:8,n:"EMEF DOM PEDRO ALCÂNTARA - CAIC"},{c:9,n:"EMEF PROF HOMERA DA SILVA BRAGA"},
            {c:10,n:"EMEF PROF IGNEZ SAGULA FOSSÁ"},{c:11,n:"EMEF PROF ILGA PUSPLATAIS"},{c:12,n:"EMEF PROF MARIA APARECIDA SANTOS RONCONI"},
            {c:13,n:"EMEF PROF MERCEDES RACHID EDWARDS"},{c:14,n:"EMEF PROF POSSIDÔNIO JOSÉ DE FREITAS"},{c:15,n:"EMEF PROF ÁLVARO GONÇALVES"},
            {c:16,n:"EMEF PROF ÁUREA CANTINHO RODRIGUES"},{c:17,n:"EMEF PROF DOSULINA CHENQUE CHAVES DE ANDRADE"},{c:18,n:"EMEF PROF ELIZABETE DE PAULA HONORATO"},
            {c:19,n:"EMEF PROF ELZA REGINA FERREIRA BEVILACQUA"},{c:20,n:"EMEF PROF FLÁVIO BERLING MACEDO"},{c:21,n:"EMEF PROF GERALDO DE ALMEIDA"},
            {c:22,n:"EMEF PROF HÉLIO AUGUSTO DE SOUZA"},{c:23,n:"EMEF PROF ILDETE MENDONÇA BARBOSA"},{c:24,n:"EMEF PROF JACYRA VIEIRA BARACHO"},
            {c:25,n:"EMEF PROF LEONOR PEREIRA NUNES GALVÃO"},{c:26,n:"EMEF PROF LUCIA PEREIRA RODRIGUES"},{c:27,n:"EMEF PROF LUIZ LEITE"},
            {c:28,n:"EMEF PROF LUZIA LEVINA APARECIDA BORGES"},{c:29,n:"EMEF PROF MARIA AMÉLIA WAKAMATSU"},{c:30,n:"EMEF PROF MARIA DE MELO"},
            {c:31,n:"EMEF PROF MARIA NAZARETH DE MOURA VERONESE"},{c:32,n:"EMEF PROF MARIA OFÉLIA VENEZIANI PEDROSA"},{c:33,n:"EMEF PROF MARIANA TEIXEIRA CORNÉLIO"},
            {c:34,n:"EMEF PROF MERCEDES CARNEVALLI KLEIN"},{c:35,n:"EMEF PROF MOACYR BENEDICTO DE SOUZA"},{c:36,n:"EMEF PROF NORMA DE CONTI SIMÃO"},
            {c:37,n:"EMEF PROF OTACÍLIA MADUREIRA DE MOURA"},{c:38,n:"EMEF PROF PALMYRA SANTANNA"},{c:39,n:"EMEF PROF ROSA TOMITA"},
            {c:40,n:"EMEF PROF RUTH NUNES DA TRINDADE"},{c:41,n:"EMEF PROF SEBASTIANA COBRA"},{c:42,n:"EMEF PROF SILVANA MARIA RIBEIRO DE ALMEIDA"},
            {c:43,n:"EMEF PROF SONIA MARIA PEREIRA SILVA"},{c:44,n:"EMEF PROF THEREZINHA DO MENINO JESUS SOARES NASCIMENTO"},{c:45,n:"EMEF PROF VERA BABO DE OLIVEIRA"},
            {c:46,n:"EMEF PROF VERA LÚCIA CARNEVALLI BARRETO"},{c:47,n:"EMEF PROF WALDEMAR RAMOS"},{c:48,n:"EMEI PROF ÂNGELA DE CASTRO FERNANDES LOPES"},
            {c:49,n:"EMEI ARTUR APARECIDO DA ROSA"},{c:50,n:"EMEI CASSIANO RICARDO"},{c:51,n:"EMEI PROF ELZA FERREIRA RAHAL"},
            {c:52,n:"EMEI FEBRÔNIO PEREIRA GOMES"},{c:53,n:"EMEI JARDIM CEREJEIRAS"},{c:54,n:"EMEI JARDIM MORUMBI"},
            {c:55,n:"EMEI JOSÉ MADUREIRA LEBRÃO"},{c:56,n:"EMEI JOSÉ PURCINI"},{c:57,n:"EMEI PROF LUIZ SUNDFELD"},
            {c:59,n:"EMEI PADRE JOÃO MARCONDES GUIMARÃES"},{c:60,n:"EMEI PADRE JOSÉ RUBENS FRANCO BONAFÉ"},{c:61,n:"EMEI PROF ANA LÚCIA DE CASTRO MICHELETTO"},
            {c:62,n:"EMEI PROF ARLINDO CAETANO FILHO"},{c:63,n:"EMEI PROF CREMILDA ALVES DE OLIVEIRA AZEVEDO"},{c:64,n:"EMEI PROF DOMINGOS DE MACEDO CUSTÓDIO"},
            {c:65,n:"EMEI PROF ÉDERA IRENE PEREIRA OL CARDOSO"},{c:66,n:"EMEI PROF IDELENA MENEZES TREFÍLIO DE CARVALHO"},{c:67,n:"EMEI PROF IRACEMA OLIVEIRA DE MELLO"},
            {c:68,n:"EMEI PROF JANE PALUMBO"},{c:69,n:"NEI PROF JOSÉ ANTERO CURSINO DOS SANTOS"},{c:70,n:"EMEI PROF JOSE SODERO BITENCOURT"},
            {c:71,n:"EMEI PROF LADIEL BENEDITO DE CARVALHO"},{c:72,n:"EMEI PROF LOURDES DE OLIVEIRA MENDES"},{c:73,n:"EMEI PROF MARIA ALICE PASQUARELLI"},
            {c:74,n:"EMEI PROF MARIA DA GLÓRIA MARIANO SANTOS"},{c:75,n:"EMEI PROF MARIA EZEQUIEL SANTANA"},{c:76,n:"EMEI PROF MARIA JOSÉ GUIDO BROGLIATO FREIRE"},
            {c:77,n:"NEI PROF MARIANITA OLIVEIRA PEREIRA SANTOS"},{c:78,n:"EMEI PROF MARILDA APARECIDA MONTEMÓR"},{c:79,n:"EMEI PROF MÁRIO CAMPANER"},
            {c:80,n:"EMEI PROF NORMA LÚCIA RODRIGUES DE ALMEIDA"},{c:81,n:"EMEI PROF OLGA FRANCO CUSTÓDIO"},{c:82,n:"EMEI PROF SANDRA REGINA ALMEIDA PAULO"},
            {c:83,n:"EMEI PROF ZELI DE TOLEDO DIAS"},{c:84,n:"EMEI PROF ZENAIDE VILALVA DE ARAÚJO"},{c:85,n:"EMEI PROF ZILDA COSTA DE OLIVEIRA"},
            {c:86,n:"EMEI TORATARO TAKITANI"},{c:87,n:"FNDE - FUNDO NACIONAL DE DESENVOLVIMENTO DA EDUCAÇÃO"},{c:88,n:"IMI PROF ARMILINDA LOCATELLI DE MACEDO"},
            {c:89,n:"IMI BENEDITO CARVALHO DOS SANTOS"},{c:90,n:"IMI DOM PEDRO DE ALCÂNTARA"},{c:91,n:"NEI FÁTIMA APARECIDA BERTHOUD"},
            {c:92,n:"IMI FLAVIO LENZI"},{c:93,n:"IMI JESUS DE NAZARÉ"},{c:94,n:"IMI PROF JOANA MATTAR DE OLIVEIRA"},
            {c:95,n:"IMI JOÃO LOPES SIMÕES"},{c:96,n:"IMI MARILDA FERREIRA DE BRITO BARROS PEREIRA"},{c:97,n:"IMI MAROCA VENEZIANI"},
            {c:98,n:"IMI MARIA APARECIDA DA SILVA SOUZA"},{c:99,n:"IMI PROF ANJELA MARIA DE SOUZA ALVES"},{c:100,n:"CIEE - CENTRO DE INTEGRAÇÃO"},
            {c:101,n:"MONDEO COMÉRCIO"},{c:102,n:"NEI ALADIR M R GOMES (NEI VIDOCA)"},{c:103,n:"EE ESTEVAM FERRI"},
            {c:104,n:"NEI ALTOS DE SANTANA"},{c:105,n:"DELEGACIA SECCIONAL SJC"},{c:106,n:"NEI CAMPOS DE SÃO JOSÉ"},
            {c:107,n:"VEREADOR MACEDO BASTOS"},{c:109,n:"NEI CASA SANTA INÊS"},{c:110,n:"NEI CHÁCARAS REUNIDAS"},
            {c:112,n:"NEI CONJUNTO INTEGRAÇÃO"},{c:113,n:"NEI COSTINHA"},{c:114,n:"NEI CRECHE DOM EPAMINONDAS"},
            {c:115,n:"NEI CRECHE ÉDEN LAR DAS CRIANÇAS"},{c:116,n:"NEI DOROTI DA SILVA DA CUNHA"},{c:117,n:"NEI EUGÊNIO DE MELO"},
            {c:118,n:"NEI FREITINHAS"},{c:119,n:"NEI JARDIM ANHEMBI"},{c:120,n:"NEI JARDIM CEREJEIRAS"},
            {c:121,n:"NEI JARDIM COLONIAL"},{c:122,n:"NEI JARDIM LIMOEIRO"},{c:124,n:"NEI JARDIM SANTA FÉ"},
            {c:125,n:"NEI JARDIM SÃO LEOPOLDO"},{c:126,n:"NEI JARDIM SÃO VICENTE"},{c:127,n:"NEI JOSÉ PAULINO BICUDO"},
            {c:128,n:"NEI POUSADA DO VALE"},{c:129,n:"NEI PROF ANA ISABEL BARBOSA"},{c:130,n:"EMEI PROF CLEANIR SANTOS MALDONADO CAMPOY"},
            {c:131,n:"NEI PROF ELZA MARIA DIAS MENDONÇA"},{c:132,n:"NEI RIO COMPRIDO"},{c:133,n:"NEI SÃO FRANCISCO XAVIER"},
            {c:134,n:"NEI TORRÃO DE OURO"},{c:135,n:"NEI VICENTE SIMIÃO LUZ"},{c:136,n:"NEI VILA CÉSAR"},
            {c:137,n:"NEI VILA PAIVA I"},{c:138,n:"POSTO DE BOMBEIROS"},{c:140,n:"NEI VILA SÃO BENEDITO"},
            {c:141,n:"NEI VILA SÃO BENTO"},{c:142,n:"NEI VILA SÃO GERALDO"},{c:144,n:"NEI VILA VENEZIANI"},
            {c:145,n:"SE - ADJ - PLANEJAMENTO EDUCACIONAL"},{c:146,n:"SE - ADJ - SUPERVISÃO ESCOLAR"},{c:147,n:"SE - ADJ - VIDA ESCOLAR"},
            {c:148,n:"SE - ASSESSORIA DE IMPRENSA"},{c:149,n:"SE - CEDEMP - CENTRO DE EDUCAÇÃO EMPREENDEDORA"},{c:150,n:"SE - CONSULTORIA JURÍDICA"},
            {c:151,n:"SE - DEB - DAE - COORDENADORIA PROGRAMAS E EVENTOS"},{c:152,n:"SE - DAF - ALMOXARIFADO"},{c:153,n:"SE - DAF - ARMAZEM"},
            {c:154,n:"SE - DEB - BIBLIOTECA PÚBLICA CASSIANO RICARDO"},{c:155,n:"SE - DAF - CONTROLE ORÇAMENTÁRIO"},{c:156,n:"SE - DAF - COORDENADORIA MERENDA ESCOLAR"},
            {c:157,n:"SE - DAF - COORDENADORIA PLANEJAMENTO E OBRAS"},{c:158,n:"SE - DAF - COORDENADORIA SERVIÇOS INTERNOS"},{c:159,n:"SE - DAF - CSI - ARQUIVO GERAL"},
            {c:160,n:"SE - DAF - CUSTOS"},{c:161,n:"SE - DAF - DAP - PROFESSOR EVENTUAL"},{c:162,n:"SE - DAF - DESENVOLVIMENTO"},
            {c:164,n:"SE - DAF - DIVISAO ADMINISTRAÇÃO DE PESSOAL"},{c:165,n:"SE - DAF - DIVISÃO APOIO DIDÁTICO PEDAGÓGICO"},{c:166,n:"SE - DAF - DIVISÃO APOIO LOGÍSTICO MANUTENÇÃO"},
            {c:167,n:"SE - DAF - DIVISAO APOIO LOGÍSTICO, OBRAS"},{c:168,n:"SE - DAF - DIVISAO CONTROLADORIA"},{c:170,n:"SE - DAF - DIVISAO SUPRIMENTOS"},
            {c:171,n:"SE - DAF - DS - SUPERVISÃO COMPRAS"},{c:172,n:"SE - DAF - EDUCAÇÃO NUTRICIONAL"},{c:173,n:"SE - DAF - MANUTENÇAO INFRA-ESTRUTURA"},
            {c:174,n:"SE - DAF - MANUTENÇÃO PREDIAL"},{c:179,n:"SE - DAF - PATRIMÔNIO"},{c:180,n:"SE - DAF - PLANING E ADMINISTRAÇÃO"},
            {c:181,n:"SE - DAF - PROGRAMAS"},{c:182,n:"ESCOLAS DE EDUCAÇÃO INFANTIL PARTICULARES"},{c:183,n:"SE - DAF - SUPERVISAO ADMINISTRAÇÃO"},
            {c:184,n:"SE - DAF - SUPERVISAO DE PESSOAL (DRH)"},{c:185,n:"SE - DAF - SUPERVISAO DE TRANSPORTE"},{c:186,n:"SE - DAF - SUPERVISAO GRÁFICA"},
            {c:187,n:"SE - DAF - TECNOLOGIA E SEGURANÇA"},{c:188,n:"SE - DEB - ARQUIVO GERAL"},{c:189,n:"SE - DEB - ASSESSORIA TÉCNICO PEDAGÓGICA"},
            {c:190,n:"SE - DEB - ATP - COORDENADORIA EDUCAÇÃO ESPECIAL"},{c:191,n:"SE - DEB - ATP - COORDENADORIA PROG EMPREENDEDORISMO"},{c:192,n:"SE - DEB - ATP - COORDENADORIA PROJETOS ESPECIAIS"},
            {c:193,n:"SE - DEB - ATP - COORDENADORIA PUBLICAÇÕES TÉCNICAS"},{c:194,n:"SE - DEB - BIBLIOTECA HÉLIO PINTO FERREIRA"},{c:195,n:"SE - DEB - BIBLIOTECA JANSEN FILHO"},
            {c:196,n:"SE - DEB - BIBLIOTECA JARDIM DAS FLORES"},{c:197,n:"SE - DEB - BIBLIOTECA QUERO LER"},{c:198,n:"SE - DEB - DAE - COORDENADORIA AUDIOVISUAL"},
            {c:199,n:"SE - DEB - DAE - COORDENADORIA FORMAÇÃO EDUCACIONAL"},{c:200,n:"EDITORA"},{c:201,n:"SE - DEB - DEF - COORDENADORIA ORIENTAÇÃO EDUCACIONAL"},
            {c:202,n:"SE - DEB - DEF - COORDENADORIA PEDAGÓGICA ANOS FINAIS"},{c:203,n:"SE - DEB - DEF - COORDENADORIA PEDAGÓGICA ANOS INICIAIS"},{c:204,n:"SE - DEB - DEF - COORDENADORIA PEDAGÓGICA EJA"},
            {c:205,n:"SE - DEB - DEF - COORDENADORIA TÉCNICA ENSINO FUNDAMENTAL"},{c:206,n:"SE - DEB - DEI - COORDENADORIA PEDAGÓGICA ED INFANTIL"},{c:207,n:"SE - DEB - DEI - COORDENADORIA TÉCNICA ED INFANTIL"},
            {c:208,n:"SE - DEB - DEI - MATERNO INFANTIL"},{c:209,n:"SE - DEB - DIVISAO APOIO EDUCACIONAL"},{c:210,n:"SE - DEB - DIVISAO DE EDUCAÇÃO INFANTIL (DEI)"},
            {c:211,n:"SE - DEB - DIVISAO DE ENSINO FUNDAMENTAL (DEF)"},{c:212,n:"SE - DEB - DIVISAO EDUCAÇÃO INFANTIL - FUNDEB"},{c:213,n:"SE - DEB - DIVISAO ENSINO PROFISSIONALIZANTE"},
            {c:214,n:"SE - DEB - DIVISAO MATERNO INFANTIL - FUNDEB"},{c:215,n:"SE - DEB - EJA CICLO I - FUNDEB"},{c:216,n:"SE - DEB - ENSINO FUNDAMENTAL - FUNDEB"},
            {c:218,n:"SE - DEI - COORDENADORIA EDUCAÇÃO ESPECIAL"},{c:219,n:"SE - DEI - COORDENADORIA INFORMÁTICA E GESTÃO"},{c:220,n:"SE - DEI - COORDENADORIA PEDAGÓGICA EDUCAÇÃO INFANTIL"},
            {c:221,n:"SE - DEI - DIVISÃO EDUCAÇÃO EMPREENDEDORA"},{c:222,n:"SE - DEI - DIVISAO ORIENT TEC EDUC BASIC"},{c:223,n:"SE - DAF - DEPARTAMENTO ADMINISTRATIVO FINANCEIRO"},
            {c:224,n:"SE - DEPARTAMENTO DE EDUCAÇÃO BÁSICA"},{c:226,n:"SE - EEI PEQUENÓPOLIS (CTA)"},{c:227,n:"SECRETARIA DA JUVENTUDE"},
            {c:228,n:"SE - EXTERNO - APAE"},{c:229,n:"SE - EXTERNO - BEM TE VI"},{c:230,n:"SE - EXTERNO - CASA DE BRINQUEDOS"},
            {c:231,n:"SE - EXTERNO - CENTRO EDUCACIONAL FONTE VIDA"},{c:232,n:"SE - EXTERNO - CEPHAS"},{c:233,n:"SE - EXTERNO - FUNDHAS"},
            {c:234,n:"SE - EXTERNO - FUNDO SOCIAL SOLIDARIEDADE"},{c:235,n:"SE - EXTERNO - PRÓ VISÃO"},{c:236,n:"SE - EXTERNO - PROJETO ADOLE SER"},
            {c:237,n:"SE - EXTERNO - PROJETO AGENTE JOVEM"},{c:238,n:"SE - EXTERNO - PROJETO AQUARELA"},{c:239,n:"SE - EXTERNO - PROJETO OLHO MÁGICO"},
            {c:240,n:"SE - EXTERNO - SORRI"},{c:241,n:"SE - GC - CONVÊNIOS CECOI"},{c:242,n:"SE - GC - SUPERVISÃO DE CONTRATO"},
            {c:243,n:"SE - GC - TRANSPORTE ESCOLAR"},{c:244,n:"SE - GCM"},{c:245,n:"SE - GESTÃO DE CONTRATOS (GC)"},
            {c:246,n:"SE - OUTROS SETORES FORA SME"},{c:247,n:"SE - PROJETO DECOLAR LESTE"},{c:248,n:"SE - PROJETO DECOLAR NORTE"},
            {c:249,n:"SE - PROJETO DECOLAR SUL"},{c:250,n:"SE - SECRETARIA ADJUNTA"},{c:251,n:"SE - SECRETARIA GERAL (GABINETE)"},
            {c:253,n:"EE MAJOR MIGUEL NAKED"},{c:254,n:"NEI JARDIM MORUMBI"},{c:255,n:"SECRETARIA DE ESPORTES E LAZER"},
            {c:256,n:"SECRETARIA DE EVENTOS OFICIAIS E TURISMO"},{c:257,n:"SECRETARIA DE SAÚDE"},{c:273,n:"EMEI GALO BRANCO"},
            {c:274,n:"SECRETARIA DE DESENVOLVIMENTO SOCIAL - SDS"},{c:275,n:"SECRETARIA DE OBRAS"},{c:293,n:"EE CÔNEGO JOSÉ FORTUNATO DA SILVA RAMOS"},
            {c:313,n:"REPUBLICA FEDERATIVA DO BRASIL"},{c:354,n:"CECOI - ACE - ASSOCIAÇÃO CRISTÃ"},{c:356,n:"CECOI - AAMU - ASSOCIAÇÃO DE APOIO E ASSISTÊNCIA A MULHER"},
            {c:357,n:"CECOI - ABAP - ASSOCIAÇÃO BENEFICIENTE ANDRÉ PUSPLATAIS"},{c:358,n:"CECOI - ACEL - LAR ESCOLAR MÃE MARIQUINHA"},{c:359,n:"CECOI - AME - ASSISTÊNCIA MATERNAL ESPÍRITA"},
            {c:360,n:"CECOI - AGMAC - GRUPO DE MÃES DE APOIO A CRECHE"},{c:361,n:"CECOI - CASEPAFE - PALAVRA DA FÉ"},{c:362,n:"CECOI - IPMMI - CASA SANTA INÊS"},
            {c:363,n:"CECOI - CEPEM - CENTRO PROMOCIONAL DE EUGÊNIO DE MELO"},{c:364,n:"CECOI - OBRA SOCIAL CÉLIO LEMOS"},{c:365,n:"CECOI - CRECHE PATRONATO NOSSA SENHORA DE APARECIDA"},
            {c:367,n:"CECOI - CRECHE MEIMEI"},{c:368,n:"CECOI - UNIVAP CRECHE DO CAMPO DOS ALEMÃES"},{c:369,n:"CECOI - UNIVAP JARDIM TELESPARK"},
            {c:370,n:"CECOI - IRMÃS CARMELITAS"},{c:371,n:"CECOI - OBRAS ASSISTÊNCIAIS IRMÃ CLARA"},{c:376,n:"VEREADOR JOÃO DAS MERCES"},
            {c:377,n:"CECOI - NOSSA SENHORA AUXILIADORA"},{c:378,n:"CECOI - PEQUENA ESTRELA"},{c:379,n:"CECOI - CORAÇÃO DE MARIA"},
            {c:380,n:"CECOI - SANTA RITA REGIÃO NORTE"},{c:381,n:"CECOI - SEARA ESPÍRITA BEZERRA DE MENEZES"},{c:382,n:"CECOI - SOCIEDADE BENEFICIENTE SÃO MATEUS"},
            {c:383,n:"CECOI - FUNDHAS - EMEF DOM PEDRO DE ALCÂNTARA"},{c:2288,n:"SEC - DEPARTAMENTO DE GESTÃO DE PROJETOS ESPECIAIS (DGPE)"},
            {c:2289,n:"SEC - DEPARTAMENTO DE ESPORTES EDUCACIONAIS (DEE)"},{c:2290,n:"SEC - MUSEU INTERATIVO DE CIÊNCIAS (MIC)"},
            {c:2292,n:"EMEI PROF DENISE PRATES FERNANDES ROCHA"},{c:2293,n:"NEI BAIRRO DOS FREITAS"},{c:2296,n:"EMEFI PROF MARIA ANTONIETA FERREIRA PAYAR"},
            {c:2297,n:"EMEFI LUIZA MARIA CAVALCANTI GURATTI"},{c:2298,n:"EMEFI EMMANUEL ANTONIO DOS SANTOS"},{c:2299,n:"EMEFI PROF ALDA DE SOUZA ARAUJO"},
            {c:2300,n:"EMEFI THEREZINHA DO MENINO JESUS SOARES DO NASCIMENTO"},{c:2301,n:"EMEI PROF MARIA LEONOR DE CAMPOS MOTA MIRANDA"},
            {c:2302,n:"EMEFI PROF AMINTAS ROCHA BRITO"},{c:2303,n:"EMEFI MAURICIO ANISSE CURY"},{c:2304,n:"EMEFI PROF EDEWALDO FREITAS GAIA SANT'ANNA"},
            {c:2305,n:"UNIVERSIDADE ABERTA DO BRASIL (UAB)"},{c:2306,n:"LABORATORIO DE EDUCAÇÃO DIGITAL E INTERATIVA (LEDI)"},
            {c:2307,n:"ESCOLA DE FORMAÇÃO DO EDUCADOR (EFE)"},{c:2308,n:"CENTRO DE EDUCAÇÃO DE JOVENS E ADULTOS (CEJA)"},{c:2309,n:"CENTRO DE FORMAÇÃO DO EDUCADOR"},
            {c:9999,n:"ARQUIVO GERAL"}
        ];

        let etiquetas = [];
        let modo = 'padrao';

        function toggleCamposEliminacao() {
            const subtipo = document.getElementById('subtipo_padrao').value;
            const camposComuns = document.getElementById('inputs-comuns');
            const camposAmostra = document.getElementById('inputs-amostragem');
            const rowAnoElim = document.getElementById('row-ano-elim');
            const lblSetor = document.getElementById('lbl-setor-principal');
            
            if (subtipo === 'eliminacao' || subtipo === 'permanente') {
                camposComuns.classList.remove('hidden');
                camposAmostra.classList.add('hidden');
                lblSetor.innerText = "Portador (Setor)";
                
                if(subtipo === 'eliminacao') rowAnoElim.style.display = 'block';
                else rowAnoElim.style.display = 'none';

            } else { 
                camposComuns.classList.add('hidden');
                camposAmostra.classList.remove('hidden');
                lblSetor.innerText = "Unidade / Setor";
            }
        }

        function buscarSetor(input, listaId) {
            const termo = input.value.toLowerCase().trim();
            const lista = document.getElementById(listaId);
            lista.innerHTML = '';
            if (termo.length < 1) { lista.style.display = 'none'; return; }
            const resultados = BASE_SETORES.filter(s => s.c.toString().startsWith(termo) || s.n.toLowerCase().includes(termo));
            if (resultados.length > 0) {
                resultados.slice(0, 10).forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'autocomplete-item';
                    div.innerHTML = `<strong>${item.c}</strong> - ${item.n}`;
                    div.onclick = () => { input.value = `${item.c} - ${item.n}`; lista.style.display = 'none'; };
                    lista.appendChild(div);
                });
                lista.style.display = 'block';
            } else { lista.style.display = 'none'; }
        }

        function setModelo(m) {
            modo = m;
            document.getElementById('btn-padrao').className = m === 'padrao' ? 'flex-1 py-2 text-xs font-bold rounded shadow-sm bg-white text-primary transition border border-gray-200' : 'flex-1 py-2 text-xs font-bold rounded text-gray-500 hover:bg-white hover:text-dark transition';
            document.getElementById('btn-numero').className = m === 'numero' ? 'flex-1 py-2 text-xs font-bold rounded shadow-sm bg-white text-dark transition border border-gray-200' : 'flex-1 py-2 text-xs font-bold rounded text-gray-500 hover:bg-white hover:text-dark transition';
            document.getElementById('campos-padrao').classList.toggle('hidden', m !== 'padrao');
            document.getElementById('campos-numero').classList.toggle('hidden', m !== 'numero');
        }

        function adicionar(e) {
            e.preventDefault();
            const dados = { tipo: modo };

            if(modo === 'padrao') {
                dados.subtipo = document.getElementById('subtipo_padrao').value;
                const valorSetor = document.getElementById('p_unidade').value;

                if(dados.subtipo === 'eliminacao' || dados.subtipo === 'permanente') {
                    dados.portador = valorSetor;
                    dados.num_doc = document.getElementById('eli_num_doc').value;
                    dados.ano_data = document.getElementById('eli_ano_data').value;
                    dados.tipo_doc = document.getElementById('eli_tipo').value;
                    dados.qtd = document.getElementById('eli_qtd').value;
                    dados.desc = document.getElementById('eli_desc').value;
                    if(dados.subtipo === 'eliminacao') {
                        dados.ano_elim = document.getElementById('eli_ano_elim').value;
                    }
                } else {
                    dados.unidade = valorSetor;
                    dados.processo = document.getElementById('a_processo').value;
                    dados.data = document.getElementById('a_data').value;
                    dados.desc = document.getElementById('a_desc').value;
                }

            } else {
                dados.setor = document.getElementById('n_setor').value || 'SETOR';
                dados.numero = document.getElementById('n_numero').value || '00';
                dados.data = document.getElementById('n_data').value || 'DATA';
            }
            etiquetas.push(dados);
            renderizar();
        }

        function preencherRestante() {
            if(etiquetas.length === 0) return alert('Adicione uma etiqueta primeiro.');
            const modelo = etiquetas[etiquetas.length - 1];
            const faltam = 6 - (etiquetas.length % 6);
            if(faltam === 6 && etiquetas.length > 0) return;
            for(let i=0; i<faltam; i++) etiquetas.push({...modelo});
            renderizar();
        }
        
        function limparFolha() { if(confirm("Limpar etiquetas?")) { etiquetas = []; renderizar(); } }
        function remover(index) { etiquetas.splice(index, 1); renderizar(); }

        document.addEventListener('click', e => {
            if (!e.target.closest('.relative')) document.querySelectorAll('.autocomplete-list').forEach(l => l.style.display = 'none');
        });

        function renderizar() {
            const container = document.getElementById('folha-a4');
            container.innerHTML = '';

            etiquetas.forEach((et, index) => {
                const div = document.createElement('div');
                div.className = 'etiqueta-box group';
                const btnDel = `<button onclick="remover(${index})" class="no-print absolute top-1 right-1 text-red-500 hover:text-red-700 opacity-0 group-hover:opacity-100 transition z-50"><i class="fa-solid fa-times-circle"></i></button>`;

                if(et.tipo === 'padrao') {
                    
                    if(et.subtipo === 'eliminacao' || et.subtipo === 'permanente') {
                        
                        let titulo = "ELIMINAÇÃO";
                        let rowSitDoc = "";
                        const valQtd = et.qtd ? et.qtd : "_______"; // Linha para preenchimento manual

                        let rodapeHtml = `
                            <div class="eli-row" style="margin-top:6px;">
                                <span class="eli-label">Qtd:</span>
                                <span class="eli-value" style="flex:0 0 80px;">${valQtd} cm</span>
                                <span class="eli-label" style="margin-left:10px;">Eliminação:</span>
                                <span class="eli-value">31/12/${et.ano_elim}</span>
                            </div>`;

                        if(et.subtipo === 'eliminacao') {
                            rowSitDoc = `
                                <div class="eli-row">
                                    <span class="eli-label">Código:</span>
                                    <span class="eli-blank-line" style="width: 120px;"></span>
                                    <span class="eli-label" style="margin-left:10px;">Sit. Doc.:</span>
                                    <span class="eli-fixed">AGUARDANDO PLAN.</span>
                                </div>
                            `;
                        } else {
                            titulo = "GUARDA PERMANENTE";
                            rowSitDoc = `
                                <div class="eli-row">
                                    <span class="eli-label">Código:</span>
                                    <span class="eli-blank-line" style="width: 120px;"></span>
                                </div>
                            `;
                            rodapeHtml = `
                                <div class="eli-row" style="margin-top:6px;">
                                    <span class="eli-label">Qtd:</span>
                                    <span class="eli-value" style="flex:0 0 80px;">${valQtd} cm</span>
                                </div>`;
                        }

                        div.innerHTML = `
                            ${btnDel}
                            <div class="layout-padrao-box">
                                <div class="eli-header">${titulo}</div>
                                <div class="eli-row">
                                    <span class="eli-label">Nº Doc.:</span>
                                    <span class="eli-value">${et.num_doc}</span>
                                    <span class="eli-label">Data:</span>
                                    <span class="eli-value">30/12/${et.ano_data}</span>
                                </div>
                                <div class="eli-row">
                                    <span class="eli-label">Portador:</span>
                                    <span class="eli-value" style="font-size:10px;">${et.portador}</span>
                                </div>
                                <div class="eli-row">
                                    <span class="eli-label">Destinatário:</span>
                                    <span class="eli-fixed">1344 – SEC. MUNICIPAL DE EDUCAÇÃO</span>
                                </div>
                                
                                ${rowSitDoc}

                                <div class="eli-row">
                                    <span class="eli-label">Tipo:</span>
                                    <span class="eli-value">${et.tipo_doc}</span>
                                </div>
                                <div style="display:flex; flex-direction:column; flex:1;">
                                    <span class="eli-label">Descrição:</span>
                                    <div class="eli-desc-box">${et.desc}</div>
                                </div>
                                ${rodapeHtml}
                            </div>
                        `;

                    } else { 
                         // --- LAYOUT AMOSTRAGEM ---
                         div.innerHTML = `
                            ${btnDel}
                            <div class="layout-amostragem">
                                <div style="border-bottom:3px double #000; padding-bottom:5px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;">
                                    <div>
                                        <h2 style="font-family:'Playfair Display', serif; font-weight:700; font-size:16px;">AMOSTRAGEM</h2>
                                        <span style="font-size:10px; text-transform:uppercase;">GUARDA DEFINITIVA</span>
                                    </div>
                                    <i class="fa-solid fa-filter text-2xl"></i>
                                </div>
                                <div style="flex:1; display:flex; flex-direction:column; gap:8px;">
                                    <div class="campo-linha"><span class="campo-label">UNIDADE:</span><span class="campo-valor">${et.unidade}</span></div>
                                    <div class="campo-linha"><span class="campo-label">PROC/CX:</span><span class="campo-valor">${et.processo}</span></div>
                                    <div class="campo-linha"><span class="campo-label">DATA:</span><span class="campo-valor">${et.data}</span></div>
                                    <div class="campo-area"><strong>CONTEÚDO:</strong><br>${et.desc}</div>
                                </div>
                            </div>
                        `;
                    }
                } else {
                    // --- NUMÉRICA ---
                    div.innerHTML = `
                        ${btnDel}
                        <div class="layout-numero">
                            <div class="num-header"><span>${et.numero}</span></div>
                            <div class="num-body"><span class="texto-setor">${et.setor}</span></div>
                            <div class="num-footer">${et.data}</div>
                        </div>
                    `;
                }
                container.appendChild(div);
            });
        }
        toggleCamposEliminacao();
    </script>
</body>
</html>
