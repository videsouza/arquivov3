<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Etiquetas | Hub.Doc</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=Playfair+Display:wght@700&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">

    <style>
        /* --- GERAL --- */
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; overflow: hidden; }
        
        /* --- AUTOCOMPLETE --- */
        .autocomplete-list {
            position: absolute; top: 100%; left: 0; right: 0;
            background: white; border: 1px solid #cbd5e1;
            border-radius: 0 0 8px 8px; max-height: 200px; overflow-y: auto;
            z-index: 50; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); display: none;
        }
        .autocomplete-item {
            padding: 8px 12px; font-size: 11px; cursor: pointer;
            border-bottom: 1px solid #f1f5f9; color: #334155;
        }
        .autocomplete-item:hover { background-color: #f1f5f9; color: #0f172a; }
        .autocomplete-item strong { color: #f59e0b; margin-right: 5px; }

        /* --- IMPRESSÃO A4 --- */
        .sheet-container {
            width: 210mm; min-height: 297mm; background: white;
            padding: 10mm; box-sizing: border-box; margin: 0 auto;
            display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: repeat(3, 1fr);
            gap: 5mm; box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .etiqueta-box {
            border: 1px dashed #e2e8f0; height: 100%; overflow: hidden;
            position: relative; background: #fff; padding: 4px; box-sizing: border-box;
        }

        /* --- ESTILOS DAS ETIQUETAS --- */

        /* 1. ELIMINAÇÃO (Visual Limpo) */
        .layout-eliminacao {
            border: 2px solid #333; height: 100%; padding: 15px;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .header-eliminacao {
            border-bottom: 2px solid #333; padding-bottom: 5px; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }

        /* 2. PERMANENTE (Visual Pesado/Escuro) */
        .layout-permanente {
            border: 4px solid #000; height: 100%; padding: 0;
            display: flex; flex-direction: column;
        }
        .header-permanente {
            background: #000; color: #fff; padding: 10px 15px;
            display: flex; justify-content: space-between; align-items: center;
            -webkit-print-color-adjust: exact; print-color-adjust: exact;
        }
        .body-permanente { padding: 15px; flex: 1; display: flex; flex-direction: column; justify-content: space-between; }

        /* 3. AMOSTRAGEM (Visual Tracejado/Híbrido) */
        .layout-amostragem {
            border: 3px double #000; height: 100%; padding: 15px;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .header-amostragem {
            border-bottom: 3px double #000; padding-bottom: 5px; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }

        /* 4. NUMÉRICA (Gigante) */
        .layout-numero {
            border: 5px solid #000; height: 100%; display: flex; flex-direction: column; text-align: center;
        }
        .num-header {
            background: #000; color: #fff; padding: 5px; height: 60px;
            display: flex; align-items: center; justify-content: center;
            -webkit-print-color-adjust: exact;
        }
        .num-header span { font-size: 40px; font-weight: 800; font-family: 'Inter', sans-serif; line-height: 1; }
        .num-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 10px; overflow: hidden; }
        .texto-setor { font-size: 30px; font-weight: 800; text-transform: uppercase; line-height: 1.1; font-family: 'Inter', sans-serif; color: #000; }
        .num-footer { border-top: 4px solid #000; padding: 8px; font-size: 20px; font-weight: 700; background: #f1f1f1; -webkit-print-color-adjust: exact; }

        /* UTILITÁRIOS DE TEXTO */
        .campo-linha { display: flex; align-items: baseline; border-bottom: 1px dotted #999; padding-bottom: 2px; margin-bottom: 6px; }
        .campo-label { font-weight: 700; font-size: 11px; min-width: 70px; color: #333; text-transform: uppercase; }
        .campo-valor { font-weight: 600; font-size: 13px; color: #000; flex: 1; margin-left: 5px; font-family: 'Roboto Mono', monospace; }
        .campo-area { margin-top: 4px; flex: 1; border: 1px solid #ddd; padding: 5px; font-size: 11px; background: #fafafa; }

        @media print {
            @page { size: A4; margin: 0; }
            body { background: white; margin: 0; padding: 0; }
            aside, .no-print { display: none !important; }
            .sheet-container { width: 210mm; height: 296mm; margin: 0; box-shadow: none; padding: 10mm; page-break-after: always; }
        }
    </style>
</head>
<body class="flex h-screen">

    <aside class="w-64 bg-slate-900 text-white flex flex-col justify-between hidden md:flex no-print h-full shrink-0">
        <div>
            <div class="p-8 border-b border-slate-800">
                <h1 class="text-2xl font-light tracking-wide text-white">Hub<span class="font-bold text-amber-500">.Doc</span></h1>
                <p class="text-[10px] text-slate-400 mt-2 font-light tracking-wider uppercase">Impressão</p>
            </div>
            <nav class="mt-8 px-4 space-y-2">
                <a href="index.html" class="w-full text-left px-4 py-3 rounded border border-slate-700 hover:bg-slate-800 text-slate-300 hover:text-white transition flex items-center gap-3 mb-6">
                    <i class="fa-solid fa-arrow-left w-5"></i> <span class="font-medium text-sm">Voltar ao Hub</span>
                </a>
                <div class="px-4 py-2 text-[10px] text-slate-500 uppercase tracking-widest font-bold border-b border-slate-800 mb-2">Comandos</div>
                <button onclick="window.print()" class="w-full text-left px-4 py-3 rounded bg-amber-600 hover:bg-amber-700 text-white shadow-lg transition flex items-center gap-3 mb-2">
                    <i class="fa-solid fa-print w-5"></i> <span class="font-medium text-sm">Imprimir</span>
                </button>
                <button onclick="limparFolha()" class="w-full text-left px-4 py-3 rounded hover:bg-slate-800 text-slate-400 hover:text-white transition flex items-center gap-3">
                    <i class="fa-solid fa-eraser w-5"></i> <span class="font-medium text-sm">Limpar</span>
                </button>
            </nav>
        </div>
        <div class="p-6 border-t border-slate-800">
             <div class="flex items-center gap-3 opacity-60">
                <div class="w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center text-slate-300 font-bold font-serif text-xs">V</div>
                <div><p class="text-xs font-bold text-white">Vinicius Souza</p></div>
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-full overflow-hidden main-content bg-slate-100">
        
        <header class="bg-white border-b border-slate-200 p-4 flex justify-between items-center shadow-sm z-10 no-print shrink-0">
            <div>
                <h2 class="text-xl font-serif text-slate-800">Gerador de Etiquetas</h2>
                <p class="text-xs text-slate-500 font-sans mt-1">Layout A4 (6 und) | Banco de Dados Atualizado (CSV).</p>
            </div>
        </header>

        <div class="flex-1 flex overflow-hidden">
            
            <div class="w-1/3 bg-white border-r border-slate-200 p-6 overflow-y-auto no-print shadow-lg z-20">
                
                <div class="flex gap-2 mb-6 p-1 bg-slate-100 rounded-lg">
                    <button onclick="setModelo('padrao')" id="btn-padrao" class="flex-1 py-2 text-xs font-bold rounded shadow bg-white text-slate-800 transition">PADRÃO</button>
                    <button onclick="setModelo('numero')" id="btn-numero" class="flex-1 py-2 text-xs font-bold rounded text-slate-500 hover:bg-white hover:shadow transition">NUMÉRICA</button>
                </div>

                <form id="formEtiqueta" onsubmit="adicionar(event)" class="space-y-4">
                    
                    <div id="campos-padrao">
                        
                        <div class="mb-4 bg-slate-50 p-3 rounded border border-slate-200">
                            <label class="block text-[10px] font-bold text-slate-400 uppercase mb-2">Finalidade da Etiqueta</label>
                            <div class="flex gap-2">
                                <label class="flex-1 cursor-pointer">
                                    <input type="radio" name="subtipo" value="eliminacao" checked class="peer sr-only" onchange="atualizarPreview()">
                                    <div class="text-center py-2 text-[10px] font-bold border rounded bg-white text-slate-500 peer-checked:bg-slate-800 peer-checked:text-white transition">ELIMINAÇÃO</div>
                                </label>
                                <label class="flex-1 cursor-pointer">
                                    <input type="radio" name="subtipo" value="permanente" class="peer sr-only" onchange="atualizarPreview()">
                                    <div class="text-center py-2 text-[10px] font-bold border rounded bg-white text-slate-500 peer-checked:bg-black peer-checked:text-white transition">PERMANENTE</div>
                                </label>
                                <label class="flex-1 cursor-pointer">
                                    <input type="radio" name="subtipo" value="amostragem" class="peer sr-only" onchange="atualizarPreview()">
                                    <div class="text-center py-2 text-[10px] font-bold border rounded bg-white text-slate-500 peer-checked:bg-amber-500 peer-checked:text-white transition">AMOSTRA</div>
                                </label>
                            </div>
                        </div>

                        <div class="mb-3 relative">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Unidade/Setor</label>
                            <div class="relative">
                                <input type="text" id="p_unidade" oninput="buscarSetor(this, 'sugestoes-padrao')" onfocus="buscarSetor(this, 'sugestoes-padrao')" autocomplete="off" class="w-full border p-2 pl-8 rounded text-sm focus:border-amber-500 outline-none uppercase" placeholder="Buscar código ou nome...">
                                <i class="fa-solid fa-search absolute left-2.5 top-2.5 text-slate-400 text-xs"></i>
                            </div>
                            <div id="sugestoes-padrao" class="autocomplete-list"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 mb-3">
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Processo/Cx</label>
                                <input type="text" id="p_processo" class="w-full border p-2 rounded text-sm focus:border-amber-500 outline-none">
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Data/Ano</label>
                                <input type="text" id="p_data" class="w-full border p-2 rounded text-sm focus:border-amber-500 outline-none" placeholder="00/00/0000">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Descrição / Conteúdo</label>
                            <textarea id="p_desc" rows="3" class="w-full border p-2 rounded text-sm focus:border-amber-500 outline-none"></textarea>
                        </div>
                    </div>

                    <div id="campos-numero" class="hidden">
                        <div class="mb-3">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Número Grande</label>
                            <input type="number" id="n_numero" class="w-full border p-2 rounded text-3xl font-bold text-center focus:border-amber-500 outline-none" placeholder="93">
                        </div>
                        <div class="mb-3 relative">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Nome do Setor</label>
                            <div class="relative">
                                <input type="text" id="n_setor" oninput="buscarSetor(this, 'sugestoes-numero')" onfocus="buscarSetor(this, 'sugestoes-numero')" autocomplete="off" class="w-full border p-2 pl-8 rounded text-sm focus:border-amber-500 outline-none font-bold uppercase" placeholder="Buscar código ou nome...">
                                <i class="fa-solid fa-search absolute left-2.5 top-2.5 text-slate-400 text-xs"></i>
                            </div>
                            <div id="sugestoes-numero" class="autocomplete-list"></div>
                        </div>
                        <div class="mb-3">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Data/Ano</label>
                            <input type="text" id="n_data" class="w-full border p-2 rounded text-sm focus:border-amber-500 outline-none" placeholder="2025">
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-slate-800 text-white py-3 rounded font-bold hover:bg-black transition flex justify-center items-center gap-2">
                        <i class="fa-solid fa-plus"></i> Adicionar
                    </button>
                    <button type="button" onclick="preencherRestante()" class="w-full bg-slate-100 text-slate-600 py-2 rounded text-xs font-bold hover:bg-slate-200 transition mt-2 border border-slate-200">
                        Completar Página
                    </button>
                    <div class="pt-4 border-t border-slate-100 mt-4">
                        <button type="button" onclick="window.print()" class="w-full bg-emerald-600 text-white py-3 rounded font-bold hover:bg-emerald-700 transition flex justify-center items-center gap-2 shadow-sm">
                            <i class="fa-solid fa-print"></i> IMPRIMIR AGORA
                        </button>
                    </div>
                </form>
            </div>

            <div class="flex-1 overflow-auto bg-slate-200 p-8 flex justify-center">
                <div id="folha-a4" class="sheet-container scale-[0.8] origin-top md:scale-100 transition-transform">
                    </div>
            </div>
        </div>
    </main>

    <script>
        // --- BANCO DE DADOS COMPLETO (CSV) ---
        const BASE_SETORES = [
            {c:1,n:"SE - DAF - COORDENADORIA DE INFORMÁTICA"},{c:2,n:"CORPO DE BOMBEIROS"},{c:3,n:"CRECHE JARDIM CASTANHEIRAS"},
            {c:4,n:"CRECHE JARDIM FLAMBOYANT"},{c:5,n:"CRECHE JARDIM TELESPARK"},{c:6,n:"EMEF PROF ANA BERLING DE MACEDO"},
            {c:7,n:"EMEF PROF ANTÔNIO PALMA SOBRINHO"},{c:8,n:"EMEF DOM PEDRO ALCÂNTARA - CAIC"},{c:9,n:"EMEF PROF HOMERA DA SILVA BRAGA"},
            {c:10,n:"EMEF PROF IGNEZ SAGULA FOSSÁ"},{c:11,n:"EMEF PROF ILGA PUSPLATAIS"},{c:12,n:"EMEF PROF MARIA APARECIDA SANTOS RONCONI"},
            {c:13,n:"EMEF PROF MERCEDES RACHID EDWARDS"},{c:14,n:"EMEF PROF POSSIDÔNIO JOSÉ DE FREITAS"},{c:15,n:"EMEF PROF ÁLVARO GONÇALVES"},
            {c:16,n:"EMEF PROF ÁUREA CANTINHO RODRIGUES"},{c:17,n:"EMEF PROF DOSULINA CHENQUE CHAVES DE ANDRADE"},{c:18,n:"EMEF PROF ELIZABETE DE PAULA HONORATO"},
            {c:19,n:"EMEF PROF ELZA REGINA FERREIRA BEVILACQUA"},{c:20,n:"EMEF PROF FLÁVIO BERLING MACEDO"},{c:21,n:"EMEF PROF GERALDO DE ALMEIDA"},
            {c:22,n:"EMEF PROF HÉLIO AUGUSTO DE SOUZA"},{c:23,n:"EMEF PROF ILDETE MENDONÇA BARBOSA"},{c:24,n:"EMEF PROF JACYRA VIEIRA BARACHO"},
            {c:25,n:"EMEF PROF LEONOR PEREIRA NUNES GALVÃO"},{c:26,n:"EMEF PROF LUCIA PEREIRA RODRIGUES"},{c:27,n:"EMEF PROF LUIZ LEITE"},
            {c:28,n:"EMEF PROF LUZIA LEVINA APARECIDA BORGES"},{c:29,n:"EMEF PROF MARIA AMÉLIA WAKAMATSU"},{c:30,n:"EMEF PROF MARIA DE MELO"},
            {c:31,n:"EMEF PROF MARIA NAZARETH DE MOURA VERONESE"},{c:32,n:"EMEF PROF MARIA OFÉLIA VENEZIANI PEDROSA"},{c:33,n:"EMEF PROF MARIANA TEIXEIRA CORNÉLIO"},
            {c:34,n:"EMEF PROF MERCEDES CARNEVALLI KLEIN"},{c:35,n:"EMEF PROF MOACYR BENEDICTO DE SOUZA"},{c:36,n:"EMEF PROF NORMA DE CONTI SIMÃO"},
            {c:37,n:"EMEF PROF OTACÍLIA MADUREIRA DE MOURA"},{c:38,n:"EMEF PROF PALMYRA SANTANNA"},{c:39,n:"EMEF PROF ROSA TOMITA"},
            {c:40,n:"EMEF PROF RUTH NUNES DA TRINDADE"},{c:41,n:"EMEF PROF SEBASTIANA COBRA"},{c:42,n:"EMEF PROF SILVANA MARIA RIBEIRO DE ALMEIDA"},
            {c:43,n:"EMEF PROF SONIA MARIA PEREIRA SILVA"},{c:44,n:"EMEF PROF THEREZINHA DO MENINO JESUS SOARES NASCIMENTO"},{c:45,n:"EMEF PROF VERA BABO DE OLIVEIRA"},
            {c:46,n:"EMEF PROF VERA LÚCIA CARNEVALLI BARRETO"},{c:47,n:"EMEF PROF WALDEMAR RAMOS"},{c:48,n:"EMEI PROF ÂNGELA DE CASTRO FERNANDES LOPES"},
            {c:49,n:"EMEI ARTUR APARECIDO DA ROSA"},{c:50,n:"EMEI CASSIANO RICARDO"},{c:51,n:"EMEI PROF ELZA FERREIRA RAHAL"},
            {c:52,n:"EMEI FEBRÔNIO PEREIRA GOMES"},{c:53,n:"EMEI JARDIM CEREJEIRAS"},{c:54,n:"EMEI JARDIM MORUMBI"},
            {c:55,n:"EMEI JOSÉ MADUREIRA LEBRÃO"},{c:56,n:"EMEI JOSÉ PURCINI"},{c:57,n:"EMEI PROF LUIZ SUNDFELD"},
            {c:59,n:"EMEI PADRE JOÃO MARCONDES GUIMARÃES"},{c:60,n:"EMEI PADRE JOSÉ RUBENS FRANCO BONAFÉ"},{c:61,n:"EMEI PROF ANA LÚCIA DE CASTRO MICHELETTO"},
            {c:62,n:"EMEI PROF ARLINDO CAETANO FILHO"},{c:63,n:"EMEI PROF CREMILDA ALVES DE OLIVEIRA AZEVEDO"},{c:64,n:"EMEI PROF DOMINGOS DE MACEDO CUSTÓDIO"},
            {c:65,n:"EMEI PROF ÉDERA IRENE PEREIRA OL CARDOSO"},{c:66,n:"EMEI PROF IDELENA MENEZES TREFÍLIO DE CARVALHO"},{c:67,n:"EMEI PROF IRACEMA OLIVEIRA DE MELLO"},
            {c:68,n:"EMEI PROF JANE PALUMBO"},{c:69,n:"NEI PROF JOSÉ ANTERO CURSINO DOS SANTOS"},{c:70,n:"EMEI PROF JOSE SODERO BITENCOURT"},
            {c:71,n:"EMEI PROF LADIEL BENEDITO DE CARVALHO"},{c:72,n:"EMEI PROF LOURDES DE OLIVEIRA MENDES"},{c:73,n:"EMEI PROF MARIA ALICE PASQUARELLI"},
            {c:74,n:"EMEI PROF MARIA DA GLÓRIA MARIANO SANTOS"},{c:75,n:"EMEI PROF MARIA EZEQUIEL SANTANA"},{c:76,n:"EMEI PROF MARIA JOSÉ GUIDO BROGLIATO FREIRE"},
            {c:77,n:"NEI PROF MARIANITA OLIVEIRA PEREIRA SANTOS"},{c:78,n:"EMEI PROF MARILDA APARECIDA MONTEMÓR"},{c:79,n:"EMEI PROF MÁRIO CAMPANER"},
            {c:80,n:"EMEI PROF NORMA LÚCIA RODRIGUES DE ALMEIDA"},{c:81,n:"EMEI PROF OLGA FRANCO CUSTÓDIO"},{c:82,n:"EMEI PROF SANDRA REGINA ALMEIDA PAULO"},
            {c:83,n:"EMEI PROF ZELI DE TOLEDO DIAS"},{c:84,n:"EMEI PROF ZENAIDE VILALVA DE ARAÚJO"},{c:85,n:"EMEI PROF ZILDA COSTA DE OLIVEIRA"},
            {c:86,n:"EMEI TORATARO TAKITANI"},{c:87,n:"FNDE - FUNDO NACIONAL DE DESENVOLVIMENTO DA EDUCAÇÃO"},{c:88,n:"IMI PROF ARMILINDA LOCATELLI DE MACEDO"},
            {c:89,n:"IMI BENEDITO CARVALHO DOS SANTOS"},{c:90,n:"IMI DOM PEDRO DE ALCÂNTARA"},{c:91,n:"NEI FÁTIMA APARECIDA BERTHOUD"},
            {c:92,n:"IMI FLAVIO LENZI"},{c:93,n:"IMI JESUS DE NAZARÉ"},{c:94,n:"IMI PROF JOANA MATTAR DE OLIVEIRA"},
            {c:95,n:"IMI JOÃO LOPES SIMÕES"},{c:96,n:"IMI MARILDA FERREIRA DE BRITO BARROS PEREIRA"},{c:97,n:"IMI MAROCA VENEZIANI"},
            {c:98,n:"IMI MARIA APARECIDA DA SILVA SOUZA"},{c:99,n:"IMI PROF ANJELA MARIA DE SOUZA ALVES"},{c:100,n:"CIEE - CENTRO DE INTEGRAÇÃO"},
            {c:101,n:"MONDEO COMÉRCIO"},{c:102,n:"NEI ALADIR M R GOMES (NEI VIDOCA)"},{c:103,n:"EE ESTEVAM FERRI"},
            {c:104,n:"NEI ALTOS DE SANTANA"},{c:105,n:"DELEGACIA SECCIONAL SJC"},{c:106,n:"NEI CAMPOS DE SÃO JOSÉ"},
            {c:107,n:"VEREADOR MACEDO BASTOS"},{c:109,n:"NEI CASA SANTA INÊS"},{c:110,n:"NEI CHÁCARAS REUNIDAS"},
            {c:112,n:"NEI CONJUNTO INTEGRAÇÃO"},{c:113,n:"NEI COSTINHA"},{c:114,n:"NEI CRECHE DOM EPAMINONDAS"},
            {c:115,n:"NEI CRECHE ÉDEN LAR DAS CRIANÇAS"},{c:116,n:"NEI DOROTI DA SILVA DA CUNHA"},{c:117,n:"NEI EUGÊNIO DE MELO"},
            {c:118,n:"NEI FREITINHAS"},{c:119,n:"NEI JARDIM ANHEMBI"},{c:120,n:"NEI JARDIM CEREJEIRAS"},
            {c:121,n:"NEI JARDIM COLONIAL"},{c:122,n:"NEI JARDIM LIMOEIRO"},{c:124,n:"NEI JARDIM SANTA FÉ"},
            {c:125,n:"NEI JARDIM SÃO LEOPOLDO"},{c:126,n:"NEI JARDIM SÃO VICENTE"},{c:127,n:"NEI JOSÉ PAULINO BICUDO"},
            {c:128,n:"NEI POUSADA DO VALE"},{c:129,n:"NEI PROF ANA ISABEL BARBOSA"},{c:130,n:"EMEI PROF CLEANIR SANTOS MALDONADO CAMPOY"},
            {c:131,n:"NEI PROF ELZA MARIA DIAS MENDONÇA"},{c:132,n:"NEI RIO COMPRIDO"},{c:133,n:"NEI SÃO FRANCISCO XAVIER"},
            {c:134,n:"NEI TORRÃO DE OURO"},{c:135,n:"NEI VICENTE SIMIÃO LUZ"},{c:136,n:"NEI VILA CÉSAR"},
            {c:137,n:"NEI VILA PAIVA I"},{c:138,n:"POSTO DE BOMBEIROS"},{c:140,n:"NEI VILA SÃO BENEDITO"},
            {c:141,n:"NEI VILA SÃO BENTO"},{c:142,n:"NEI VILA SÃO GERALDO"},{c:144,n:"NEI VILA VENEZIANI"},
            {c:145,n:"SE - ADJ - PLANEJAMENTO EDUCACIONAL"},{c:146,n:"SE - ADJ - SUPERVISÃO ESCOLAR"},{c:147,n:"SE - ADJ - VIDA ESCOLAR"},
            {c:148,n:"SE - ASSESSORIA DE IMPRENSA"},{c:149,n:"SE - CEDEMP - CENTRO DE EDUCAÇÃO EMPREENDEDORA"},{c:150,n:"SE - CONSULTORIA JURÍDICA"},
            {c:151,n:"SE - DEB - DAE - COORDENADORIA PROGRAMAS E EVENTOS"},{c:152,n:"SE - DAF - ALMOXARIFADO"},{c:153,n:"SE - DAF - ARMAZEM"},
            {c:154,n:"SE - DEB - BIBLIOTECA PÚBLICA CASSIANO RICARDO"},{c:155,n:"SE - DAF - CONTROLE ORÇAMENTÁRIO"},{c:156,n:"SE - DAF - COORDENADORIA MERENDA ESCOLAR"},
            {c:157,n:"SE - DAF - COORDENADORIA PLANEJAMENTO E OBRAS"},{c:158,n:"SE - DAF - COORDENADORIA SERVIÇOS INTERNOS"},{c:159,n:"SE - DAF - CSI - ARQUIVO GERAL"},
            {c:160,n:"SE - DAF - CUSTOS"},{c:161,n:"SE - DAF - DAP - PROFESSOR EVENTUAL"},{c:162,n:"SE - DAF - DESENVOLVIMENTO"},
            {c:164,n:"SE - DAF - DIVISAO ADMINISTRAÇÃO DE PESSOAL"},{c:165,n:"SE - DAF - DIVISÃO APOIO DIDÁTICO PEDAGÓGICO"},{c:166,n:"SE - DAF - DIVISÃO APOIO LOGÍSTICO MANUTENÇÃO"},
            {c:167,n:"SE - DAF - DIVISAO APOIO LOGÍSTICO, OBRAS"},{c:168,n:"SE - DAF - DIVISAO CONTROLADORIA"},{c:170,n:"SE - DAF - DIVISAO SUPRIMENTOS"},
            {c:171,n:"SE - DAF - DS - SUPERVISÃO COMPRAS"},{c:172,n:"SE - DAF - EDUCAÇÃO NUTRICIONAL"},{c:173,n:"SE - DAF - MANUTENÇAO INFRA-ESTRUTURA"},
            {c:174,n:"SE - DAF - MANUTENÇÃO PREDIAL"},{c:179,n:"SE - DAF - PATRIMÔNIO"},{c:180,n:"SE - DAF - PLANING E ADMINISTRAÇÃO"},
            {c:181,n:"SE - DAF - PROGRAMAS"},{c:182,n:"ESCOLAS DE EDUCAÇÃO INFANTIL PARTICULARES"},{c:183,n:"SE - DAF - SUPERVISAO ADMINISTRAÇÃO"},
            {c:184,n:"SE - DAF - SUPERVISAO DE PESSOAL (DRH)"},{c:185,n:"SE - DAF - SUPERVISAO DE TRANSPORTE"},{c:186,n:"SE - DAF - SUPERVISAO GRÁFICA"},
            {c:187,n:"SE - DAF - TECNOLOGIA E SEGURANÇA"},{c:188,n:"SE - DEB - ARQUIVO GERAL"},{c:189,n:"SE - DEB - ASSESSORIA TÉCNICO PEDAGÓGICA"},
            {c:190,n:"SE - DEB - ATP - COORDENADORIA EDUCAÇÃO ESPECIAL"},{c:191,n:"SE - DEB - ATP - COORDENADORIA PROG EMPREENDEDORISMO"},{c:192,n:"SE - DEB - ATP - COORDENADORIA PROJETOS ESPECIAIS"},
            {c:193,n:"SE - DEB - ATP - COORDENADORIA PUBLICAÇÕES TÉCNICAS"},{c:194,n:"SE - DEB - BIBLIOTECA HÉLIO PINTO FERREIRA"},{c:195,n:"SE - DEB - BIBLIOTECA JANSEN FILHO"},
            {c:196,n:"SE - DEB - BIBLIOTECA JARDIM DAS FLORES"},{c:197,n:"SE - DEB - BIBLIOTECA QUERO LER"},{c:198,n:"SE - DEB - DAE - COORDENADORIA AUDIOVISUAL"},
            {c:199,n:"SE - DEB - DAE - COORDENADORIA FORMAÇÃO EDUCACIONAL"},{c:200,n:"EDITORA"},{c:201,n:"SE - DEB - DEF - COORDENADORIA ORIENTAÇÃO EDUCACIONAL"},
            {c:202,n:"SE - DEB - DEF - COORDENADORIA PEDAGÓGICA ANOS FINAIS"},{c:203,n:"SE - DEB - DEF - COORDENADORIA PEDAGÓGICA ANOS INICIAIS"},{c:204,n:"SE - DEB - DEF - COORDENADORIA PEDAGÓGICA EJA"},
            {c:205,n:"SE - DEB - DEF - COORDENADORIA TÉCNICA ENSINO FUNDAMENTAL"},{c:206,n:"SE - DEB - DEI - COORDENADORIA PEDAGÓGICA ED INFANTIL"},{c:207,n:"SE - DEB - DEI - COORDENADORIA TÉCNICA ED INFANTIL"},
            {c:208,n:"SE - DEB - DEI - MATERNO INFANTIL"},{c:209,n:"SE - DEB - DIVISAO APOIO EDUCACIONAL"},{c:210,n:"SE - DEB - DIVISAO DE EDUCAÇÃO INFANTIL (DEI)"},
            {c:211,n:"SE - DEB - DIVISAO DE ENSINO FUNDAMENTAL (DEF)"},{c:212,n:"SE - DEB - DIVISAO EDUCAÇÃO INFANTIL - FUNDEB"},{c:213,n:"SE - DEB - DIVISAO ENSINO PROFISSIONALIZANTE"},
            {c:214,n:"SE - DEB - DIVISAO MATERNO INFANTIL - FUNDEB"},{c:215,n:"SE - DEB - EJA CICLO I - FUNDEB"},{c:216,n:"SE - DEB - ENSINO FUNDAMENTAL - FUNDEB"},
            {c:218,n:"SE - DEI - COORDENADORIA EDUCAÇÃO ESPECIAL"},{c:219,n:"SE - DEI - COORDENADORIA INFORMÁTICA E GESTÃO"},{c:220,n:"SE - DEI - COORDENADORIA PEDAGÓGICA EDUCAÇÃO INFANTIL"},
            {c:221,n:"SE - DEI - DIVISÃO EDUCAÇÃO EMPREENDEDORA"},{c:222,n:"SE - DEI - DIVISAO ORIENT TEC EDUC BASIC"},{c:223,n:"SE - DAF - DEPARTAMENTO ADMINISTRATIVO FINANCEIRO"},
            {c:224,n:"SE - DEPARTAMENTO DE EDUCAÇÃO BÁSICA"},{c:226,n:"SE - EEI PEQUENÓPOLIS (CTA)"},{c:227,n:"SECRETARIA DA JUVENTUDE"},
            {c:228,n:"SE - EXTERNO - APAE"},{c:229,n:"SE - EXTERNO - BEM TE VI"},{c:230,n:"SE - EXTERNO - CASA DE BRINQUEDOS"},
            {c:231,n:"SE - EXTERNO - CENTRO EDUCACIONAL FONTE VIDA"},{c:232,n:"SE - EXTERNO - CEPHAS"},{c:233,n:"SE - EXTERNO - FUNDHAS"},
            {c:234,n:"SE - EXTERNO - FUNDO SOCIAL SOLIDARIEDADE"},{c:235,n:"SE - EXTERNO - PRÓ VISÃO"},{c:236,n:"SE - EXTERNO - PROJETO ADOLE SER"},
            {c:237,n:"SE - EXTERNO - PROJETO AGENTE JOVEM"},{c:238,n:"SE - EXTERNO - PROJETO AQUARELA"},{c:239,n:"SE - EXTERNO - PROJETO OLHO MÁGICO"},
            {c:240,n:"SE - EXTERNO - SORRI"},{c:241,n:"SE - GC - CONVÊNIOS CECOI"},{c:242,n:"SE - GC - SUPERVISÃO DE CONTRATO"},
            {c:243,n:"SE - GC - TRANSPORTE ESCOLAR"},{c:244,n:"SE - GCM"},{c:245,n:"SE - GESTÃO DE CONTRATOS (GC)"},
            {c:246,n:"SE - OUTROS SETORES FORA SME"},{c:247,n:"SE - PROJETO DECOLAR LESTE"},{c:248,n:"SE - PROJETO DECOLAR NORTE"},
            {c:249,n:"SE - PROJETO DECOLAR SUL"},{c:250,n:"SE - SECRETARIA ADJUNTA"},{c:251,n:"SE - SECRETARIA GERAL (GABINETE)"},
            {c:253,n:"EE MAJOR MIGUEL NAKED"},{c:254,n:"NEI JARDIM MORUMBI"},{c:255,n:"SECRETARIA DE ESPORTES E LAZER"},
            {c:256,n:"SECRETARIA DE EVENTOS OFICIAIS E TURISMO"},{c:257,n:"SECRETARIA DE SAÚDE"},{c:273,n:"EMEI GALO BRANCO"},
            {c:274,n:"SECRETARIA DE DESENVOLVIMENTO SOCIAL - SDS"},{c:275,n:"SECRETARIA DE OBRAS"},{c:293,n:"EE CÔNEGO JOSÉ FORTUNATO DA SILVA RAMOS"},
            {c:313,n:"REPUBLICA FEDERATIVA DO BRASIL"},{c:354,n:"CECOI - ACE - ASSOCIAÇÃO CRISTÃ"},{c:356,n:"CECOI - AAMU - ASSOCIAÇÃO DE APOIO E ASSISTÊNCIA A MULHER"},
            {c:357,n:"CECOI - ABAP - ASSOCIAÇÃO BENEFICIENTE ANDRÉ PUSPLATAIS"},{c:358,n:"CECOI - ACEL - LAR ESCOLAR MÃE MARIQUINHA"},{c:359,n:"CECOI - AME - ASSISTÊNCIA MATERNAL ESPÍRITA"},
            {c:360,n:"CECOI - AGMAC - GRUPO DE MÃES DE APOIO A CRECHE"},{c:361,n:"CECOI - CASEPAFE - PALAVRA DA FÉ"},{c:362,n:"CECOI - IPMMI - CASA SANTA INÊS"},
            {c:363,n:"CECOI - CEPEM - CENTRO PROMOCIONAL DE EUGÊNIO DE MELO"},{c:364,n:"CECOI - OBRA SOCIAL CÉLIO LEMOS"},{c:365,n:"CECOI - CRECHE PATRONATO NOSSA SENHORA DE APARECIDA"},
            {c:367,n:"CECOI - CRECHE MEIMEI"},{c:368,n:"CECOI - UNIVAP CRECHE DO CAMPO DOS ALEMÃES"},{c:369,n:"CECOI - UNIVAP JARDIM TELESPARK"},
            {c:370,n:"CECOI - IRMÃS CARMELITAS"},{c:371,n:"CECOI - OBRAS ASSISTÊNCIAIS IRMÃ CLARA"},{c:376,n:"VEREADOR JOÃO DAS MERCES"},
            {c:377,n:"CECOI - NOSSA SENHORA AUXILIADORA"},{c:378,n:"CECOI - PEQUENA ESTRELA"},{c:379,n:"CECOI - CORAÇÃO DE MARIA"},
            {c:380,n:"CECOI - SANTA RITA REGIÃO NORTE"},{c:381,n:"CECOI - SEARA ESPÍRITA BEZERRA DE MENEZES"},{c:382,n:"CECOI - SOCIEDADE BENEFICIENTE SÃO MATEUS"},
            {c:383,n:"CECOI - FUNDHAS - EMEF DOM PEDRO DE ALCÂNTARA"},{c:2288,n:"SEC - DEPARTAMENTO DE GESTÃO DE PROJETOS ESPECIAIS (DGPE)"},
            {c:2289,n:"SEC - DEPARTAMENTO DE ESPORTES EDUCACIONAIS (DEE)"},{c:2290,n:"SEC - MUSEU INTERATIVO DE CIÊNCIAS (MIC)"},
            {c:2292,n:"EMEI PROF DENISE PRATES FERNANDES ROCHA"},{c:2293,n:"NEI BAIRRO DOS FREITAS"},{c:2296,n:"EMEFI PROF MARIA ANTONIETA FERREIRA PAYAR"},
            {c:2297,n:"EMEFI LUIZA MARIA CAVALCANTI GURATTI"},{c:2298,n:"EMEFI EMMANUEL ANTONIO DOS SANTOS"},{c:2299,n:"EMEFI PROF ALDA DE SOUZA ARAUJO"},
            {c:2300,n:"EMEFI THEREZINHA DO MENINO JESUS SOARES DO NASCIMENTO"},{c:2301,n:"EMEI PROF MARIA LEONOR DE CAMPOS MOTA MIRANDA"},
            {c:2302,n:"EMEFI PROF AMINTAS ROCHA BRITO"},{c:2303,n:"EMEFI MAURICIO ANISSE CURY"},{c:2304,n:"EMEFI PROF EDEWALDO FREITAS GAIA SANT'ANNA"},
            {c:2305,n:"UNIVERSIDADE ABERTA DO BRASIL (UAB)"},{c:2306,n:"LABORATORIO DE EDUCAÇÃO DIGITAL E INTERATIVA (LEDI)"},
            {c:2307,n:"ESCOLA DE FORMAÇÃO DO EDUCADOR (EFE)"},{c:2308,n:"CENTRO DE EDUCAÇÃO DE JOVENS E ADULTOS (CEJA)"},{c:2309,n:"CENTRO DE FORMAÇÃO DO EDUCADOR"},
            {c:9999,n:"ARQUIVO GERAL"}
        ];

        let etiquetas = [];
        let modo = 'padrao';

        function buscarSetor(input, listaId) {
            const termo = input.value.toLowerCase().trim();
            const lista = document.getElementById(listaId);
            lista.innerHTML = '';
            if (termo.length < 1) { lista.style.display = 'none'; return; }
            
            const resultados = BASE_SETORES.filter(s => 
                s.c.toString().startsWith(termo) || 
                s.n.toLowerCase().includes(termo)
            );

            if (resultados.length > 0) {
                resultados.slice(0, 15).forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'autocomplete-item';
                    div.innerHTML = `<strong>${item.c}</strong> - ${item.n}`;
                    div.onclick = () => { input.value = `${item.c} - ${item.n}`; lista.style.display = 'none'; };
                    lista.appendChild(div);
                });
                lista.style.display = 'block';
            } else { lista.style.display = 'none'; }
        }

        function setModelo(m) {
            modo = m;
            document.getElementById('btn-padrao').className = m === 'padrao' ? 'flex-1 py-2 text-xs font-bold rounded shadow bg-white text-slate-800 transition border border-slate-300' : 'flex-1 py-2 text-xs font-bold rounded text-slate-400 hover:bg-white hover:shadow transition';
            document.getElementById('btn-numero').className = m === 'numero' ? 'flex-1 py-2 text-xs font-bold rounded shadow bg-white text-slate-800 transition border border-slate-300' : 'flex-1 py-2 text-xs font-bold rounded text-slate-400 hover:bg-white hover:shadow transition';
            document.getElementById('campos-padrao').classList.toggle('hidden', m !== 'padrao');
            document.getElementById('campos-numero').classList.toggle('hidden', m !== 'numero');
        }

        function adicionar(e) {
            e.preventDefault();
            const dados = { tipo: modo };

            if(modo === 'padrao') {
                dados.subtipo = document.querySelector('input[name="subtipo"]:checked').value;
                dados.unidade = document.getElementById('p_unidade').value;
                dados.processo = document.getElementById('p_processo').value;
                dados.data = document.getElementById('p_data').value;
                dados.desc = document.getElementById('p_desc').value;
            } else {
                dados.setor = document.getElementById('n_setor').value || 'SETOR';
                dados.numero = document.getElementById('n_numero').value || '00';
                dados.data = document.getElementById('n_data').value || 'DATA';
            }
            etiquetas.push(dados);
            renderizar();
        }

        function preencherRestante() {
            if(etiquetas.length === 0) return alert('Adicione uma etiqueta primeiro.');
            const modelo = etiquetas[etiquetas.length - 1];
            const faltam = 6 - (etiquetas.length % 6);
            if(faltam === 6 && etiquetas.length > 0) return;
            for(let i=0; i<faltam; i++) etiquetas.push({...modelo});
            renderizar();
        }

        function limparFolha() { if(confirm("Limpar?")) { etiquetas = []; renderizar(); } }
        function remover(index) { etiquetas.splice(index, 1); renderizar(); }
        function atualizarPreview() { /* Opcional: Atualizar preview instantâneo */ }
        
        // FECHAR LISTAS AO CLICAR FORA
        document.addEventListener('click', e => {
            if (!e.target.closest('.relative')) document.querySelectorAll('.autocomplete-list').forEach(l => l.style.display = 'none');
        });

        function renderizar() {
            const container = document.getElementById('folha-a4');
            container.innerHTML = '';

            etiquetas.forEach((et, index) => {
                const div = document.createElement('div');
                div.className = 'etiqueta-box group';
                const btnDel = `<button onclick="remover(${index})" class="no-print absolute top-1 right-1 text-red-500 hover:text-red-700 opacity-0 group-hover:opacity-100 transition z-50"><i class="fa-solid fa-times-circle"></i></button>`;

                if(et.tipo === 'padrao') {
                    // CONFIGURAÇÃO DOS TIPOS VISUAIS
                    let layoutClass = 'layout-eliminacao';
                    let headerClass = 'header-eliminacao';
                    let tituloHeader = 'ELIMINAÇÃO';
                    let subHeader = 'DOCUMENTO INTERMEDIÁRIO';

                    if(et.subtipo === 'permanente') {
                        layoutClass = 'layout-permanente';
                        headerClass = 'header-permanente';
                        tituloHeader = 'GUARDA PERMANENTE';
                        subHeader = 'NÃO ELIMINAR';
                    } else if(et.subtipo === 'amostragem') {
                        layoutClass = 'layout-amostragem';
                        headerClass = 'header-amostragem';
                        tituloHeader = 'AMOSTRAGEM';
                        subHeader = 'GUARDA DEFINITIVA';
                    }

                    div.innerHTML = `
                        ${btnDel}
                        <div class="${layoutClass}">
                            <div class="${headerClass}">
                                <div>
                                    <h2 style="font-family:'Playfair Display', serif; font-weight:700; font-size:16px;">${tituloHeader}</h2>
                                    <span style="font-size:10px; text-transform:uppercase; letter-spacing:1px;">${subHeader}</span>
                                </div>
                                <i class="fa-solid fa-box-archive text-2xl"></i>
                            </div>
                            <div style="flex:1; display:flex; flex-direction:column; gap:4px;">
                                <div class="campo-linha"><span class="campo-label">UNIDADE:</span><span class="campo-valor">${et.unidade}</span></div>
                                <div class="campo-linha"><span class="campo-label">PROC/CX:</span><span class="campo-valor">${et.processo}</span></div>
                                <div class="campo-linha"><span class="campo-label">DATA:</span><span class="campo-valor">${et.data}</span></div>
                                <div class="campo-area"><strong>CONTEÚDO:</strong><br>${et.desc}</div>
                            </div>
                            <div style="text-align:center; font-size:9px; margin-top:5px; color:#999;">Hub.Doc System</div>
                        </div>
                    `;
                } else {
                    div.innerHTML = `
                        ${btnDel}
                        <div class="layout-numero">
                            <div class="num-header"><span>${et.numero}</span></div>
                            <div class="num-body"><span class="texto-setor">${et.setor}</span></div>
                            <div class="num-footer">${et.data}</div>
                        </div>
                    `;
                }
                container.appendChild(div);
            });
        }
    </script>
</body>
</html>
